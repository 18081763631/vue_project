{"remainingRequest":"C:\\Users\\lenovo\\Desktop\\vue-admin\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\lenovo\\Desktop\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\lenovo\\Desktop\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lenovo\\Desktop\\vue-admin\\src\\views\\manage\\roles.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lenovo\\Desktop\\vue-admin\\src\\views\\manage\\roles.vue","mtime":1585839394000},{"path":"C:\\Users\\lenovo\\Desktop\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\vue-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getList, del, change, delAll, changeAll } from '@/api/roles';\nimport waves from '@/directive/waves';\nimport { pickerOptions, getArrByKey } from '@/utils';\nimport rolesForm from \"./roles/form\";\nexport default {\n  name: 'Roles',\n  components: {\n    rolesForm: rolesForm\n  },\n  directives: {\n    waves: waves\n  },\n  filters: {\n    statusFilter: function statusFilter(status) {\n      var statusMap = {\n        0: '禁用',\n        1: '正常'\n      };\n      return statusMap[status];\n    }\n  },\n  data: function data() {\n    return {\n      tableKey: 0,\n      list: null,\n      total: null,\n      selectedRows: null,\n      listLoading: true,\n      showSearch: false,\n      listQuery: {\n        page: 1,\n        psize: 10,\n        status: '-1',\n        title: ''\n      },\n      buttonDisabled: true,\n      deleting: false,\n      pickerOptions: pickerOptions,\n      currentIndex: -1\n    };\n  },\n  watch: {},\n  created: function created() {\n    this.fetchList();\n  },\n  methods: {\n    fetchList: function fetchList() {\n      var _this2 = this;\n\n      this.listLoading = true;\n      getList(this.listQuery).then(function (response) {\n        _this2.list = response.data.data;\n        _this2.total = response.data.total;\n        _this2.listLoading = false;\n      });\n    },\n    handleFilter: function handleFilter() {\n      this.listQuery.page = 1;\n      this.fetchList();\n    },\n    handleFilterClear: function handleFilterClear() {\n      this.listQuery = {\n        page: 1,\n        psize: 10,\n        status: '-1',\n        title: ''\n      };\n      this.fetchList();\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.listQuery.psize = val;\n      this.fetchList();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.listQuery.page = val;\n      this.fetchList();\n    },\n    handleModifyStatus: function handleModifyStatus(index, id, status) {\n      this.list[index]['status'] = 1 - status;\n      change(id, 'status', 1 - status).then(function (response) {});\n    },\n    handleSelectionChange: function handleSelectionChange(val) {\n      if (val.length > 0) {\n        this.buttonDisabled = false;\n      } else {\n        this.buttonDisabled = true;\n      }\n\n      this.selectedRows = val;\n    },\n    handleCreate: function handleCreate() {\n      this.$refs.fromRoles.handleCreate();\n    },\n    handleUpdate: function handleUpdate(index, id) {\n      this.currentIndex = index;\n      this.$refs.fromRoles.handleUpdate(id);\n    },\n    updateRow: function updateRow(temp) {\n      if (this.currentIndex >= 0 && temp.id > 0) {\n        this.list.splice(this.currentIndex, 1, temp);\n      } else {\n        if (this.list.length >= 10) {\n          this.list.pop();\n        }\n\n        this.list.push(temp);\n        this.total = this.total + 1;\n      }\n\n      this.currentIndex = -1;\n    },\n    handleDelete: function handleDelete(index, id) {\n      var _this3 = this;\n\n      var _this = this;\n\n      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this.$set(_this.list[index], 'delete', true);\n\n        del(id).then(function (response) {\n          if (response.status === 1) {\n            _this.list.splice(index, 1);\n\n            _this.total = _this.total - 1;\n\n            _this.$notify.success(response.msg);\n          } else {\n            _this.$notify.error(response.msg);\n          }\n\n          _this.$set(_this.list[index], 'delete', false);\n        }).catch(function (error) {\n          _this.$set(_this.list[index], 'delete', false);\n        });\n      }).catch(function () {\n        _this3.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    handleDeleteAll: function handleDeleteAll() {\n      var _this4 = this;\n\n      var _this = this;\n\n      if (this.selectedRows.length > 0) {\n        this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          _this.deleting = true;\n          var ids = getArrByKey(_this.selectedRows, 'id');\n          var idstr = ids.join(',');\n          delAll({\n            ids: idstr\n          }).then(function (response) {\n            if (response.status === 1) {\n              var delindex = [];\n\n              _this.list.forEach(function (item, index, input) {\n                if (ids.indexOf(item.id) > -1) {\n                  delindex.push(index);\n                }\n              });\n\n              for (var i = delindex.length - 1; i >= 0; i--) {\n                _this.list.splice(delindex[i], 1);\n              }\n\n              _this.total = _this.total - delindex.length;\n\n              _this.$message.success(response.msg);\n            } else {\n              _this.$message.error(response.msg);\n            }\n\n            _this.deleting = false;\n          }).catch(function (error) {\n            _this.deleting = false;\n          });\n        }).catch(function () {\n          _this4.$message({\n            type: 'info',\n            message: '已取消删除'\n          });\n        });\n      } else {\n        _this.$message.error('请选择要删除的数据');\n      }\n    },\n    handleCommand: function handleCommand(command) {\n      var _this = this;\n\n      if (this.selectedRows.length > 0) {\n        var ids = getArrByKey(this.selectedRows, 'id');\n        var idstr = ids.join(',');\n        changeAll({\n          val: idstr,\n          field: 'status',\n          value: command\n        }).then(function (response) {\n          if (response.status === 1) {\n            _this.list.forEach(function (item, index, input) {\n              if (ids.indexOf(item.id) > -1) {\n                _this.list[index]['status'] = command;\n              }\n            });\n\n            _this.$message.success(response.msg);\n          } else {\n            _this.$message.error(response.msg);\n          }\n        }).catch(function (error) {});\n      } else {\n        _this.$message.error('请选择要操作的数据');\n      }\n    }\n  }\n};",{"version":3,"sources":["roles.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!-- 搜索 -->\n    <div v-if=\"showSearch\" class=\"filter-container\">\n      <el-form :inline=\"true\" :model=\"listQuery\" class=\"form-inline\">\n        <el-form-item label=\"\">\n          <el-input v-model=\"listQuery.title\" placeholder=\"名称\" clearable size=\"small\"/>\n        </el-form-item>\n        <el-form-item label=\"\">\n          <el-select v-model=\"listQuery.status\" placeholder=\"状态\" clearable size=\"small\">\n            <el-option label=\"全部\" value=\"-1\"/>\n            <el-option label=\"正常\" value=\"1\"/>\n            <el-option label=\"禁用\" value=\"0\"/>\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button v-waves type=\"primary\" icon=\"el-icon-search\" size=\"small\" @click=\"handleFilter\">搜索</el-button>\n        </el-form-item>\n        <el-form-item>\n          <el-button v-waves type=\"warning\" icon=\"el-icon-refresh\" size=\"small\" @click=\"handleFilterClear\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n\n    <!-- 操作 -->\n    <el-row style=\"margin-bottom: 10px;\">\n      <el-col :xs=\"24\" :sm=\"24\" :lg=\"24\">\n        <el-tooltip content=\"刷新\" placement=\"top\">\n          <el-button v-waves type=\"warning\" icon=\"el-icon-refresh\" circle @click=\"handleFilterClear\"/>\n        </el-tooltip>\n        <el-tooltip content=\"添加\" placement=\"top\">\n          <el-button v-waves type=\"success\" icon=\"el-icon-plus\" circle @click=\"handleCreate\"/>\n        </el-tooltip>\n        <el-tooltip content=\"搜索\" placement=\"top\">\n          <el-button v-waves type=\"primary\" icon=\"el-icon-search\" circle @click=\"showSearch = !showSearch\"/>\n        </el-tooltip>\n        <el-tooltip content=\"删除\" placement=\"top\">\n          <el-button v-waves :loading=\"deleting\" :disabled=\"buttonDisabled\" type=\"danger\" icon=\"el-icon-delete\" circle @click=\"handleDeleteAll()\"/>\n        </el-tooltip>\n        <el-tooltip content=\"更多\" placement=\"top\">\n          <el-dropdown trigger=\"click\" placement=\"bottom\" style=\"margin-left: 10px;\" @command=\"handleCommand\">\n            <el-button :disabled=\"buttonDisabled\" type=\"Info\" circle>\n              <i class=\"el-icon-more\"/>\n            </el-button>\n            <el-dropdown-menu slot=\"dropdown\" >\n              <el-dropdown-item command=\"1\">设为正常</el-dropdown-item>\n              <el-dropdown-item command=\"0\">设为禁用</el-dropdown-item>\n            </el-dropdown-menu>\n          </el-dropdown>\n        </el-tooltip>\n      </el-col>\n    </el-row>\n\n    <!-- 表格 -->\n    <el-table\n      v-loading=\"listLoading\"\n      :key=\"tableKey\"\n      :data=\"list\"\n      border\n      fit\n      highlight-current-row\n      style=\"width: 100%;\"\n      @selection-change=\"handleSelectionChange\">\n      <el-table-column type=\"selection\" width=\"55\"/>\n      <el-table-column label=\"ID\" align=\"center\" width=\"65\" >\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.id }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"名称\" min-width=\"100px\" >\n        <template slot-scope=\"scope\">\n          <span class=\"link-type\" @click=\"handleUpdate(scope.$index,scope.row.id)\">{{ scope.row.title }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"状态\" width=\"110px\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <span :class=\"{'el-icon-success text-green':scope.row.status == 1,'el-icon-error text-red':scope.row.status == 0}\" @click=\"handleModifyStatus(scope.$index,scope.row.id,scope.row.status)\">{{ scope.row.status | statusFilter }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" align=\"center\" width=\"120px\" class-name=\"small-padding\" >\n        <template slot-scope=\"scope\">\n          <el-tooltip content=\"编辑\" placement=\"top\">\n            <el-button v-waves type=\"primary\" icon=\"el-icon-edit-outline\" circle @click=\"handleUpdate(scope.$index,scope.row.id)\"/>\n          </el-tooltip>\n          <el-tooltip content=\"删除\" placement=\"top\">\n            <el-button v-waves :loading=\"scope.row.delete\" type=\"danger\" icon=\"el-icon-delete\" circle @click=\"handleDelete(scope.$index,scope.row.id)\"/>\n          </el-tooltip>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <!-- 分页 -->\n    <div class=\"pagination-container\">\n      <el-pagination v-show=\"total>0\" :current-page=\"listQuery.page\" :page-sizes=\"[10,20,30, 50]\" :page-size=\"listQuery.psize\" :total=\"total\" background layout=\"total, sizes, prev, pager, next, jumper\" @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\"/>\n    </div>\n\n    <!-- 表单 -->\n    <rolesForm ref=\"fromRoles\" @updateRow=\"updateRow\"/>\n\n  </div>\n</template>\n\n<script>\nimport { getList, del, change, delAll, changeAll } from '@/api/roles'\nimport waves from '@/directive/waves'\nimport { pickerOptions, getArrByKey } from '@/utils'\nimport rolesForm from './roles/form'\n\nexport default {\n  name: 'Roles',\n  components: { rolesForm },\n  directives: {\n    waves\n  },\n  filters: {\n    statusFilter(status) {\n      const statusMap = {\n        0: '禁用',\n        1: '正常'\n      }\n      return statusMap[status]\n    }\n  },\n  data() {\n    return {\n      tableKey: 0,\n      list: null,\n      total: null,\n      selectedRows: null,\n      listLoading: true,\n      showSearch: false,\n      listQuery: {\n        page: 1,\n        psize: 10,\n        status: '-1',\n        title: ''\n      },\n      buttonDisabled: true,\n      deleting: false,\n      pickerOptions: pickerOptions,\n      currentIndex: -1\n    }\n  },\n  watch: {\n  },\n  created() {\n    this.fetchList()\n  },\n  methods: {\n    fetchList() {\n      this.listLoading = true\n      getList(this.listQuery).then(response => {\n        this.list = response.data.data\n        this.total = response.data.total\n        this.listLoading = false\n      })\n    },\n    handleFilter() {\n      this.listQuery.page = 1\n      this.fetchList()\n    },\n    handleFilterClear() {\n      this.listQuery = {\n        page: 1,\n        psize: 10,\n        status: '-1',\n        title: ''\n      }\n      this.fetchList()\n    },\n    handleSizeChange(val) {\n      this.listQuery.psize = val\n      this.fetchList()\n    },\n    handleCurrentChange(val) {\n      this.listQuery.page = val\n      this.fetchList()\n    },\n    handleModifyStatus(index, id, status) {\n      this.list[index]['status'] = 1 - status\n      change(id, 'status', 1 - status).then(response => {})\n    },\n    handleSelectionChange(val) {\n      if (val.length > 0) {\n        this.buttonDisabled = false\n      } else {\n        this.buttonDisabled = true\n      }\n      this.selectedRows = val\n    },\n    handleCreate() {\n      this.$refs.fromRoles.handleCreate()\n    },\n    handleUpdate(index, id) {\n      this.currentIndex = index\n      this.$refs.fromRoles.handleUpdate(id)\n    },\n    updateRow(temp) {\n      if (this.currentIndex >= 0 && temp.id > 0) {\n        this.list.splice(this.currentIndex, 1, temp)\n      } else {\n        if (this.list.length >= 10) {\n          this.list.pop()\n        }\n        this.list.push(temp)\n        this.total = this.total + 1\n      }\n      this.currentIndex = -1\n    },\n    handleDelete(index, id) {\n      const _this = this\n      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        _this.$set(_this.list[index], 'delete', true)\n        del(id).then(response => {\n          if (response.status === 1) {\n            _this.list.splice(index, 1)\n            _this.total = _this.total - 1\n            _this.$notify.success(response.msg)\n          } else {\n            _this.$notify.error(response.msg)\n          }\n          _this.$set(_this.list[index], 'delete', false)\n        }).catch((error) => {\n          _this.$set(_this.list[index], 'delete', false)\n        })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    },\n    handleDeleteAll() {\n      const _this = this\n      if (this.selectedRows.length > 0) {\n        this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          _this.deleting = true\n          const ids = getArrByKey(_this.selectedRows, 'id')\n          const idstr = ids.join(',')\n          delAll({ ids: idstr }).then(response => {\n            if (response.status === 1) {\n              const delindex = []\n              _this.list.forEach(function(item, index, input) {\n                if (ids.indexOf(item.id) > -1) {\n                  delindex.push(index)\n                }\n              })\n              for (let i = delindex.length - 1; i >= 0; i--) {\n                _this.list.splice(delindex[i], 1)\n              }\n              _this.total = _this.total - delindex.length\n              _this.$message.success(response.msg)\n            } else {\n              _this.$message.error(response.msg)\n            }\n            _this.deleting = false\n          }).catch((error) => {\n            _this.deleting = false\n          })\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          })\n        })\n      } else {\n        _this.$message.error('请选择要删除的数据')\n      }\n    },\n    handleCommand(command) {\n      const _this = this\n      if (this.selectedRows.length > 0) {\n        const ids = getArrByKey(this.selectedRows, 'id')\n        const idstr = ids.join(',')\n        changeAll({ val: idstr, field: 'status', value: command }).then(response => {\n          if (response.status === 1) {\n            _this.list.forEach(function(item, index, input) {\n              if (ids.indexOf(item.id) > -1) {\n                _this.list[index]['status'] = command\n              }\n            })\n            _this.$message.success(response.msg)\n          } else {\n            _this.$message.error(response.msg)\n          }\n        }).catch((error) => {\n        })\n      } else {\n        _this.$message.error('请选择要操作的数据')\n      }\n    }\n  }\n}\n</script>\n<style rel=\"stylesheet/scss\" lang=\"scss\">\n\t.text-red{\n\t\tcolor: red;\n\t\tcursor: pointer;\n\t}\n\t.text-green{\n\t\tcolor: green;\n\t\tcursor: pointer;\n\t}\n</style>\n"],"sourceRoot":"src/views/manage"}]}